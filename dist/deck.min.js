"use strict";var Deck=function(){function n(n,o){var e=Date.now(),r=e+n,i=r+o,u={start:r,end:i};x.push(u),v||(v=!0,requestAnimationFrame(t));var a={start:function(n){return u.startcb=n,a},progress:function(n){return u.progresscb=n,a},end:function(n){return u.endcb=n,a}};return a}function t(){var n=Date.now();if(!x.length)return void(v=!1);for(var o,e=0;e<x.length;e++)if(o=x[e],!(n<o.start)){o.started||(o.started=!0,o.startcb&&o.startcb());var r=(n-o.start)/(o.end-o.start);o.progresscb&&o.progresscb(r<1?r:1),n>o.end&&(o.endcb&&o.endcb(),x.splice(e--,1))}requestAnimationFrame(t)}function o(n){if(void 0!==I[n])return I[n];if(void 0!==C[n])return I[n]=n,n;for(var t,o=n[0].toUpperCase()+n.slice(1),e=["webkit","moz","Moz","ms","o"],r=0,i=e.length;r<i;r++)if(t=e[r]+o,void 0!==C[t])return I[n]=t,t}function e(n,t,o){return void 0!==b||(b=r()),o=o||0,b?"translate3d("+n+", "+t+", "+o+")":"translate("+n+", "+t+")"}function r(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return!1;var n=o("transform"),t=document.createElement("p");return document.body.appendChild(t),t.style[n]="translate3d(1px,1px,1px)",b=t.style[n],b=null!=b&&b.length&&"none"!==b,document.body.removeChild(t),b}function i(n){return document.createElement(n)}function u(t){function r(n){function t(n){k&&("mousemove"===n.type?(i.x=n.clientX,i.y=n.clientY):(i.x=n.touches[0].clientX,i.y=n.touches[0].clientY),x.style[y]=e(Math.round(M.x+i.x-r.x)+"px",Math.round(M.y+i.y-r.y)+"px")+(M.rot?" rotate("+M.rot+"deg)":""))}function o(n){w&&Date.now()-u<200&&M.setSide("front"===M.side?"back":"front"),"mouseup"===n.type?(d(window,"mousemove",t),d(window,"mouseup",o)):(d(window,"touchmove",t),d(window,"touchend",o)),k&&(M.x=M.x+i.x-r.x,M.y=M.y+i.y-r.y)}var r={},i={},u=Date.now();n.preventDefault(),"mousedown"===n.type?(r.x=i.x=n.clientX,r.y=i.y=n.clientY,c(window,"mousemove",t),c(window,"mouseup",o)):(r.x=i.x=n.touches[0].clientX,r.y=i.y=n.touches[0].clientY,c(window,"touchmove",t),c(window,"touchend",o)),k&&(x.style[y]=e(M.x+"px",M.y+"px")+(M.rot?" rotate("+M.rot+"deg)":""),x.style.zIndex=S++)}function u(n){n.appendChild(x),M.$root=n}function f(){M.$root&&M.$root.removeChild(x),M.$root=null}function s(n){"front"===n?("back"===M.side&&x.removeChild(g),M.side="front",x.appendChild(b),M.setRankSuit(M.rank,M.suit)):("front"===M.side&&x.removeChild(b),M.side="back",x.appendChild(g),x.setAttribute("class","card"))}var l,y=o("transform"),p=t%13+1,h=t/13|0,v=(52-t)/4,x=i("div"),b=i("div"),g=i("div"),k=!1,w=!1,M={i:t,rank:p,suit:h,pos:t,$el:x,mount:u,unmount:f,setSide:s},q=m.modules;b.classList.add("face"),g.classList.add("back"),x.style[y]=e(-v+"px",-v+"px"),M.x=-v,M.y=-v,M.z=v,M.rot=0,M.setSide("back"),c(x,"mousedown",r),c(x,"touchstart",r);for(l in q)!function(n){n.card&&n.card(M)}(q[l]);return M.animateTo=function(t){var o,r,i,u,a,c,d=t.delay,f=t.duration,s=t.x,l=void 0===s?M.x:s,p=t.y,h=void 0===p?M.y:p,m=t.rot,v=void 0===m?M.rot:m,b=t.ease,g=t.onStart,k=t.onProgress,w=t.onComplete;n(d,f).start(function(){o=M.x||0,r=M.y||0,i=M.rot||0,g&&g()}).progress(function(n){var t=E[b||"cubicInOut"](n);u=l-o,a=h-r,c=v-i,k&&k(n,t),M.x=o+u*t,M.y=r+a*t,M.rot=i+c*t,x.style[y]=e(M.x+"px",M.y+"px")+(c?"rotate("+M.rot+"deg)":"")}).end(function(){w&&w()})},M.setRankSuit=function(n,t){var o=a(t);x.setAttribute("class","card "+o+" rank"+n)},M.setRankSuit(p,h),M.enableDragging=function(){k||(k=!0,x.style.cursor="move")},M.enableFlipping=function(){w||(w=!0)},M.disableFlipping=function(){w&&(w=!1)},M.disableDragging=function(){k&&(k=!1,x.style.cursor="")},M}function a(n){return 0===n?"spades":1===n?"hearts":2===n?"clubs":3===n?"diamonds":"joker"}function c(n,t,o){n.addEventListener(t,o)}function d(n,t,o){n.removeEventListener(t,o)}function f(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function s(n){return(Math.round(Math.random())?-1:1)*n}function l(n){for(var t,o,e=n.length-1;e;e--)t=Math.floor(Math.random()*(e+1)),o=n[e],n[e]=n[t],n[t]=o;return n}function y(n){return n*Math.PI/180}function p(n){function t(n){return function(){var t=this,e=arguments;o(function(o){n.apply(t,r.concat.apply(o,e))})}}function o(n){n&&(i.push(n),1===i.length&&e())}function e(){i[0](function(n){if(n)throw n;i=i.slice(1),i.length&&e()})}var r=Array.prototype,i=[];return n.queue=o,n.queued=t,n}function h(n){function t(n,t,o){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:o})}function o(n,t,o){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:o,once:!0})}function e(n){var t=this,o=Array.prototype.slice(arguments,1);(i[n]||[]).filter(function(n){return n.cb.apply(t,o),!n.once})}function r(n,t){return n?t?void(i[n]=i[n].filter(function(n){return n.cb!==t})):void(i[n]=[]):void(i={})}n||(n={});var i={};return n.on=t,n.one=o,n.off=r,n.trigger=e,n}function m(n){function t(n){e=n,e.appendChild(c)}function o(){e.removeChild(c)}var e,r,a=new Array(n?55:52),c=i("div"),d=h({mount:t,unmount:o,cards:a,$el:c}),f=m.modules;p(d);for(r in f)!function(n){n.deck&&n.deck(d)}(f[r]);c.classList.add("deck");for(var s,l=a.length;l;l--)s=a[l-1]=u(l-1),s.setSide("back"),s.mount(c);return d}var v,x=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var b,g,k,w,M,q,C=document.createElement("p").style,I={},S=52,E={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:(4-2*n)*n-1},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},T=10,$=3,z={deck:function(n){function t(t){var o=n.cards,e=o.length;g=f(),o.slice(-T*$).reverse().forEach(function(n,o){n.cao(o,e,function(o){var e=o>=T*($-1);n.setSide(e?"back":"front"),o===T*$-1&&t()})})}n.cao=n.queued(t)},card:function(n){var t=n.$el;n.cao=function(o,e,r){var i=250*o,u=Math.floor(o/T)+1,a=Math.floor(360/T),c=2*Math.cos(a*(o%T)*Math.PI/180),d=2*Math.sin(a*(o%T)*Math.PI/180);n.animateTo({delay:i,duration:250,x:Math.round(120*(c+.2*u)*g/16),y:Math.round(100*d*g/16),rot:0,onStart:function(){t.style.zIndex=e-1+o},onComplete:function(){r(o)}})}}},A={deck:function(n){function t(t,o){var e=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,t){n.setSide(o||(e>.5?"back":"front"))}),t()}n.flip=n.queued(t)}},O={deck:function(n){function t(t,o){var e=n.cards;e.sort(function(n,t){return o?n.i-t.i:t.i-n.i}),e.forEach(function(n,r){n.sort(r,e.length,function(n){n===e.length-1&&t()},o)})}n.sort=n.queued(t)},card:function(n){var t=n.$el;n.sort=function(o,e,r,i){var u=o/4,a=10*o;n.animateTo({delay:a,duration:400,x:-u,y:-150,rot:0,onComplete:function(){t.style.zIndex=o}}),n.animateTo({delay:a+500,duration:400,x:-u,y:-u,rot:0,onComplete:function(){r(o)}})}}},P={deck:function(n){function t(t){var o=n.cards;k=f(),l(o),o.forEach(function(n,e){n.pos=e,n.shuffle(function(n){n===o.length-1&&t()})})}n.shuffle=n.queued(t)},card:function(n){var t=n.$el;n.shuffle=function(o){var e=n.pos,r=e/4,i=2*e;n.animateTo({delay:i,duration:200,x:s(40*Math.random()+20)*k/16,y:-r,rot:0}),n.animateTo({delay:200+i,duration:200,x:-r,y:-r,rot:0,onStart:function(){t.style.zIndex=e},onComplete:function(){o(e)}})}}},D={deck:function(n){function t(t){var o=n.cards,e=o.length;w=f(),o.slice(-5).reverse().forEach(function(n,o){n.poker(o,e,function(o){n.setSide("front"),4===o&&t()})})}n.poker=n.queued(t)},card:function(n){var t=n.$el;n.poker=function(o,e,r){var i=250*o;n.animateTo({delay:i,duration:250,x:Math.round(70*(o-2.05)*w/16),y:Math.round(-110*w/16),rot:0,onStart:function(){t.style.zIndex=e-1+o},onComplete:function(){r(o)}})}}},F={deck:function(t){function o(o){var e=t.cards;e.forEach(function(t,r){t.setSide("front"),t.intro(r,function(r){n(250,0).start(function(){t.setSide("back")}),r===e.length-1&&o()})})}t.intro=t.queued(o)},card:function(n){var t=o("transform"),r=n.$el;n.intro=function(o,i){var u=500+10*o,a=o/4;r.style[t]=e(-a+"px","-250px"),r.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:u,duration:1e3,x:-a,y:-a,onStart:function(){r.style.zIndex=o},onProgress:function(n){r.style.opacity=n},onComplete:function(){r.style.opacity="",i&&i(o)}})}}},L={deck:function(n){function t(t){var o=n.cards,e=o.length;M=f(),o.forEach(function(n,r){n.fan(r,e,function(n){n===o.length-1&&t()})})}n.fan=n.queued(t)},card:function(n){var t=n.$el;n.fan=function(o,e,r){var i=o/4,u=10*o,a=o/(e-1)*260-130;n.animateTo({delay:u,duration:300,x:-i,y:-i,rot:0}),n.animateTo({delay:300+u,duration:300,x:55*Math.cos(y(a-90))*M/16,y:55*Math.sin(y(a-90))*M/16,rot:a,onStart:function(){t.style.zIndex=o},onComplete:function(){r(o)}})}}},X={deck:function(n){function t(t){var o=n.cards;q=f(),o.forEach(function(n){n.bysuit(function(n){n===o.length-1&&t()})})}n.bysuit=n.queued(t)},card:function(n){var t=n.rank,o=n.suit;n.bysuit=function(e){var r=n.i,i=10*r;n.animateTo({delay:i,duration:400,x:-Math.round(8*(6.75-t)*q/16),y:-Math.round(92*(1.5-o)*q/16),rot:0,onComplete:function(){e(r)}})}}};return m.animationFrames=n,m.ease=E,m.modules={bysuit:X,fan:L,intro:F,poker:D,shuffle:P,sort:O,flip:A,cao:z},m.Card=u,m.prefix=o,m.translate=e,m}();